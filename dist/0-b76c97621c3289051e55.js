webpackJsonp([0],{506:function(module,exports,__webpack_require__){var addOddTypeCtrl=__webpack_require__(528),addOddTypeTemp=__webpack_require__(523),addSportCtrl=__webpack_require__(520),addSportTemp=__webpack_require__(519);module.exports=function($scope,betType,betTypesResource,ngDialog,confirmationWindow,cacheSvc){this.title=betType?"Manage Bet Type":"Create new Bet Type",this.isManage=!!betType;var ctrl=this,bt=betTypesResource;this.buttonText=this.isManage?"Save changes":"Create Bet Type",this.betTypeData={name:null,code:null,description:null,shortName:null,ordering:null,oddsColumnCount:null,liveEvent:{options:[{id:0,name:"Prematch"},{id:1,name:"Live"},{id:2,name:"Both"}],value:null},group:{options:null,value:null},oddsView:{options:[],value:null},oddTypes:null,sports:null},this.loadBetTypeViews=function(method){cacheSvc[method]("betTypeViews").then(function(betTypeViews){ctrl.betTypeData.oddsView.options=betTypeViews,betType?ctrl.betTypeData.oddsView.options.forEach(function(item,i){item.Id===betType.BetTypeViewID&&(ctrl.betTypeData.oddsView.value=ctrl.betTypeData.oddsView.options[i])}):ctrl.betTypeData.oddsView.value=ctrl.betTypeData.oddsView.options[0]})},this.loadBetTypeViews("get"),this.initManageData=function(betType){ctrl.betTypeData.name=betType.Name,ctrl.betTypeData.code=betType.Code,ctrl.betTypeData.description=betType.Description,ctrl.betTypeData.shortName=betType.ShortName,ctrl.betTypeData.ordering=betType.Ordering,ctrl.betTypeData.oddsView.options.forEach(function(data,i){betType.BetTypeViewID==data.Id&&(ctrl.betTypeData.oddsView.value=ctrl.betTypeData.oddsView.options[i])}),ctrl.betTypeData.liveEvent.options.forEach(function(data,i){betType.LiveType==data.id&&(ctrl.betTypeData.liveEvent.value=ctrl.betTypeData.liveEvent.options[i])}),setTimeout(function(){bt.getOdds(betType.Id).then(function(odds){ctrl.betTypeData.oddTypes=odds})}),setTimeout(function(){bt.getSports(betType.Id).then(function(sports){ctrl.betTypeData.sports=sports})})},this.initDefaultData=function(){ctrl.betTypeData.liveEvent.value=ctrl.betTypeData.liveEvent.options[0],ctrl.betTypeData.oddsView.value=ctrl.betTypeData.oddsView.options[0]},this.initModule=function(){ctrl.isManage?ctrl.initManageData(betType):ctrl.initDefaultData()},this.initModule(),this.updateBetType=function(){ctrl.isManage?confirmationWindow.open().then(function(){bt.update(betType.Id,ctrl.betTypeData.code,ctrl.betTypeData.name,ctrl.betTypeData.oddsView.value.Id,ctrl.betTypeData.description,ctrl.betTypeData.shortName,ctrl.betTypeData.liveEvent.value.id,ctrl.betTypeData.ordering),$scope.confirm(!0)}):confirmationWindow.open().then(function(){bt.create(ctrl.betTypeData.code,ctrl.betTypeData.name,ctrl.betTypeData.oddsView.value.Id,ctrl.betTypeData.description,ctrl.betTypeData.shortName,ctrl.betTypeData.liveEvent.value.id,ctrl.betTypeData.ordering),$scope.confirm(!0)})},this.deleteBetType=function(){confirmationWindow.open("Are you sure want to delete this Bet Type?").then(function(){bt["delete"](betType.Id).then(function(){$scope.confirm(1)})})},this.updateOddType=function(oddType){ngDialog.openConfirm({template:addOddTypeTemp,plain:!0,controller:addOddTypeCtrl,controllerAs:"vm",resolve:{oddType:function(){return oddType},oddTypesArray:function(){return ctrl.betTypeData.oddTypes}}}).then(function(ot){oddType?bt.updateOdd(oddType.Id,ot.oddType,ot.title,ot.ordering,ot.column,ot.shortName).then(function(){bt.getOdds(betType.Id).then(function(odds){ctrl.betTypeData.oddTypes=odds})}):bt.createOdd(betType.Id,ot.oddType,ot.title,ot.ordering,ot.column,ot.shortName).then(function(){bt.getOdds(betType.Id).then(function(odds){ctrl.betTypeData.oddTypes=odds})})})},this.deleteOddType=function(Id){confirmationWindow.open().then(function(){bt.deleteOdd(Id).then(function(){bt.getOdds(betType.Id).then(function(odds){ctrl.betTypeData.oddTypes=odds})})})},this.addSport=function(){ngDialog.openConfirm({template:addSportTemp,plain:!0,controller:addSportCtrl,controllerAs:"vm",width:"800px"}).then(function(sportId){bt.addSport(sportId,betType.Id).then(function(){bt.getSports(betType.Id).then(function(sports){ctrl.betTypeData.sports=sports})})})},this.deleteSport=function(Id){confirmationWindow.open().then(function(){bt.deleteSport(Id).then(function(){bt.getSports(betType.Id).then(function(sports){ctrl.betTypeData.sports=sports})})})},setTimeout(function(){componentHandler.upgradeAllRegistered()})}},519:function(module,exports){module.exports='<modal-wrapper>\r\n  <br>\r\n  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\r\n    <input class="mdl-textfield__input" type="text" ng-model="vm.searchBySport.$">\r\n    <label class="mdl-textfield__label text-upper">Search in sports</label>\r\n  </div>\r\n  <br>\r\n  <div style="overflow-y: auto; max-height: 60vh;">\r\n    <table class="material__table-small full-width">\r\n      <thead>\r\n      <tr class="text-upper text-primary">\r\n        <th>Code</th>\r\n        <th>Name</th>\r\n        <th>Title</th>\r\n      </tr>\r\n      </thead>\r\n      <tbody>\r\n      <tr ng-click="confirm(sport.ID)" class="hover" ng-repeat="sport in vm.sports | filter: vm.searchBySport track by $index ">\r\n        <td ng-bind="sport.Code"></td>\r\n        <td ng-bind="sport.Name"></td>\r\n        <td ng-bind="sport.Title"></td>\r\n      </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</modal-wrapper>\r\n'},520:function(module,exports){module.exports=function(cacheSvc){var _this=this;this.sports=[],this.searchBySports=null,cacheSvc.get("systemSports").then(function(systemSports){_this.sports=systemSports}),setTimeout(function(){componentHandler.upgradeAllRegistered()},100)}},523:function(module,exports){module.exports='<modal-wrapper>\r\n  <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">\r\n    <div class="mdl-tabs__tab-bar">\r\n      <a href="#system__oddTypesModal__general" class="mdl-tabs__tab is-active">General</a>\r\n      <a ng-show="vm.isManage" href="#system__oddTypesModal__sportMembers" class="mdl-tabs__tab">Sport Members</a>\r\n    </div>\r\n\r\n    <div class="mdl-tabs__panel is-active" id="system__oddTypesModal__general">\r\n      <form ng-submit="confirm(vm.data)">\r\n\r\n        <ul class=\'mdl-list\'>\r\n\r\n          <li class="mdl-list__item">\r\n            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\r\n              <input ng-model="vm.data.oddType" tabindex="3" class="mdl-textfield__input" type="number"\r\n                     placeholder="Type here..." required>\r\n              <label class="mdl-textfield__label"><strong>ODD TYPE</strong></label>\r\n            </div>\r\n          </li>\r\n\r\n          <li class="mdl-list__item">\r\n            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\r\n              <input ng-model="vm.data.title" tabindex="1" class="mdl-textfield__input" type="text"\r\n                     placeholder="Type here..." autofocus required>\r\n              <label class="mdl-textfield__label"><strong>TITLE</strong></label>\r\n            </div>\r\n          </li>\r\n\r\n          <li class="mdl-list__item">\r\n            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\r\n              <input ng-model="vm.data.ordering" tabindex="4" class="mdl-textfield__input" type="number"\r\n                     placeholder="Type here..." required>\r\n              <label class="mdl-textfield__label"><strong>ORDERING</strong></label>\r\n            </div>\r\n          </li>\r\n\r\n          <li class="mdl-list__item">\r\n            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\r\n              <input ng-model="vm.data.column" tabindex="5" class="mdl-textfield__input" type="number"\r\n                     placeholder="Type here..." required>\r\n              <label class="mdl-textfield__label"><strong>COLUMN</strong></label>\r\n            </div>\r\n          </li>\r\n\r\n          <li class="mdl-list__item">\r\n            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">\r\n              <input ng-model="vm.data.shortName" tabindex="2" class="mdl-textfield__input" type="text"\r\n                     placeholder="Type here...">\r\n              <label class="mdl-textfield__label"><strong>SHORT NAME</strong></label>\r\n            </div>\r\n          </li>\r\n\r\n        </ul>\r\n\r\n        <button type="submit" tabindex="6" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"\r\n                ng-bind="vm.buttonText"></button>\r\n      </form>\r\n\r\n    </div>\r\n    <div class="mdl-tabs__panel" id="system__oddTypesModal__sportMembers">\r\n      <br>\r\n      <div class="overflow-auto max__height-500">\r\n        <table class="material__table-small">\r\n          <thead>\r\n          <tr>\r\n            <th>Changed</th>\r\n            <th>Name</th>\r\n            <th>\r\n              <button class="pull-right mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab" ng-click="vm.addSport()">\r\n                <i class="material-icons">add</i>\r\n              </button>\r\n            </th>\r\n          </tr>\r\n          </thead>\r\n          <tbody>\r\n          <tr ng-repeat="sport in vm.sports track by $index">\r\n            <td ng-bind="sport.ChangedDate | date: \'yyyy-MM-dd | HH:mm\'"></td>\r\n            <td ng-bind="sport.SportName"></td>\r\n            <td>\r\n              <button class="pull-right mdl-button mdl-js-button mdl-button--icon" ng-click="vm.deleteSport(sport.Id)">\r\n                <i class="material-icons">delete</i>\r\n              </button>\r\n            </td>\r\n          </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</modal-wrapper>\r\n'},528:function(module,exports,__webpack_require__){var addSportTemp=__webpack_require__(519),addSportCtrl=__webpack_require__(520);module.exports=function(oddType,oddTypesArray,betTypesResource,ngDialog){"use strict";var bt=betTypesResource,ctrl=this;this.buttonText=oddType?"Update":"Create",this.isManage=!!oddType,this.sports=[],this.refreshSports=function(){setTimeout(function(){ctrl.isManage&&bt.getOddTypeSports(oddType.Id).then(function(oddTypeSports){ctrl.sports=oddTypeSports})})},this.refreshSports(),this.findMax=function(arr,fieldName){var initValue=0;return arr.forEach(function(item){item[fieldName]>initValue&&(initValue=item[fieldName])}),initValue},this.createColumn=function(maxColumn){return maxColumn<3&&maxColumn>0?maxColumn+1:3===maxColumn?1:void 0},setTimeout(function(){oddType?ctrl.data={oddType:oddType.OddType,title:oddType.Title,ordering:oddType.Ordering,column:oddType.SetColumn,shortName:oddType.ShortName}:ctrl.data={oddType:ctrl.findMax(oddTypesArray,"OddType")+1,title:null,ordering:ctrl.findMax(oddTypesArray,"Ordering")+1,column:ctrl.createColumn(oddTypesArray[oddTypesArray.length-1].SetColumn),shortName:null}}),this.addSport=function(){ngDialog.openConfirm({template:addSportTemp,plain:!0,controller:addSportCtrl,controllerAs:"vm",width:"800px",disableAnimation:!0}).then(function(sportId){bt.addOddTypeSport(sportId,oddType.Id).then(function(){ctrl.refreshSports()})})},this.deleteSport=function(Id){bt.deleteOddTypeSport(Id).then(function(){ctrl.refreshSports()})},setTimeout(function(){componentHandler.upgradeAllRegistered()})}}});