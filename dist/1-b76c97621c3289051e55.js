webpackJsonp([1],{514:function(module,exports,__webpack_require__){var initLanguageModule=__webpack_require__(531),initDroprowns=__webpack_require__(530);module.exports=function($scope,distTemplate,usersResource,cacheSvc,toastr){"use strict";var u=usersResource,_this=this;initLanguageModule(_this,cacheSvc,u,toastr,distTemplate),initDroprowns(_this,cacheSvc,distTemplate),this.distTemplate=distTemplate,this.name=distTemplate?distTemplate.Name:null,this.oddsKey=distTemplate?distTemplate.OddsKey:null,this.mult=distTemplate?distTemplate.Mult:null,this.minimumOffer=distTemplate?distTemplate.MinimumOffer:null,this.maximumCap=distTemplate?distTemplate.MaximumCap:null,this.buttonText=distTemplate?"Save changes":"Create",this.modified={oddsKey:null,mult:null,minimumOffer:null,maximumCap:null},this.client={options:null,model:null},this.copyFrom={options:null,model:null,initialValues:{OddsKey:_this.oddsKey,Mult:_this.mult,MinimumOffer:_this.minimumOffer,MaximumCap:_this.maximumCap}},this.submit=function(){var method=distTemplate?"update":"create",req={DistributeTemplateId:distTemplate?distTemplate.ID:null,Name:_this.name,ServiceId:_this.service.model?_this.service.model.Id:null,Us_ClientId:_this.client.model?_this.client.model.ID:null,OddsKey:_this.oddsKey,Mult:_this.mult,MinimumOffer:_this.minimumOffer,MaximumCap:_this.maximumCap,DistributeTemplateIdBase:_this.copyFrom.model?_this.copyFrom.model.ID:null,OddsKeyCopy:_this.modified.oddsKey,MultCopy:_this.modified.mult,MinimumOfferCopy:_this.modified.minimumOffer,MaximumCapCopy:_this.modified.maximumCap};u.distributeTemplates[method](req).then(function(){$scope.confirm(!0)})},this.service={options:null,model:null},this.autoCompleteFields=function(){var copyFromField=_this.copyFrom.model?"model":"initialValues";_this.oddsKey=_this.copyFrom[copyFromField].OddsKey,_this.mult=_this.copyFrom[copyFromField].Mult,_this.minimumOffer=_this.copyFrom[copyFromField].MinimumOffer,_this.maximumCap=_this.copyFrom[copyFromField].MaximumCap},setTimeout(function(){componentHandler.upgradeAllRegistered()},150)}},530:function(module,exports){module.exports=function(_this,cacheSvc,distTemplate){"use strict";cacheSvc.get("clients").then(function(clients){_this.client.options=clients,distTemplate&&_this.client.options.forEach(function(option,i){option.ID===distTemplate.Us_ClientID&&(_this.client.model=_this.client.options[i])})}),cacheSvc.get("sources").then(function(sources){_this.service.options=sources,distTemplate?_this.service.options.forEach(function(item,i){item.Id===distTemplate.ServiceID&&(_this.service.model=_this.service.options[i])}):_this.service.model=_this.service.options[0]}),cacheSvc.get("distTemplates").then(function(templates){_this.copyFrom.options=templates})}},531:function(module,exports){module.exports=function(_this,cacheSvc,u,toastr,distTemplate){_this.templateLanguagesTable=null,_this.language={options:null,model:null},_this.loadDistLanguages=function(needToRefresh){_this.templateLanguagesTable&&!needToRefresh||u.distributeTemplates.getDistributedLanguages({ID:distTemplate.ID}).then(function(templateLanguages){_this.templateLanguagesTable=templateLanguages}),_this.language.options||cacheSvc.get("translationsLanguages").then(function(languages){_this.language.options=languages,_this.language.model=_this.language.options[0]})},_this.deleteDistLanguage=function(ID){u.distributeTemplates.deleteDistributedLanguage({ID:ID}).then(function(){_this.loadDistLanguages(!0)})},_this.languageAlreadyExist=function(){var flag=!1;return _this.templateLanguagesTable.forEach(function(language){language.LanguageName===_this.language.model.Name&&(flag=!0)}),flag},_this.addDistLanguage=function(){_this.languageAlreadyExist()?toastr.warning("Selected language already exist!"):u.distributeTemplates.addDistributedLanguage({distTemplateID:distTemplate.ID,LanguageID:_this.language.model.ID}).then(function(){_this.loadDistLanguages(!0)})}}}});